

<!DOCTYPE html>
<html class="no-js" lang="en">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Build multiple GKE clusters with inter-Kubernetes networking | ScyllaDB Docs 
        </title>
        <meta name="description" content="ScyllaDB is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
        <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../_static/img/favicon-228x228.png" />

        
            
            
        

        
            
            <link rel="canonical" href="https://operator.docs.scylladb.com/stable/multidc/gke.html"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                  href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>
        
            
                <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/css/main.css?v=7ab9d605" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/sphinx_collapse.css?v=226d88b4" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
            
        
    
        
        
            
        <script type="text/javascript" src="../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../_static/js/main.bundle.js"></script>
        
            
                <script src="../_static/documentation_options.js?v=5929fcd5"></script>
            
        
            
                <script src="../_static/doctools.js?v=9a2dae69"></script>
            
        
            
                <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
            
        
            
                <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
            
        
            
                <script src="../_static/copybutton.js?v=f281be69"></script>
            
        
            
                <script src="../_static/design-tabs.js?v=36754332"></script>
            
        
    
            
                <!-- Local meta tags -->
            
            
                <!-- Google Tag Manager docs -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-54NWVS4");
</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager global -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
            
        
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/b1870adf6a.js" crossorigin="anonymous"></script>
        <!-- End Font Awesome -->
    </head>

    <body>
        <section class="promo-banner  promo-banner--hide" style="display: none;">
    <div class="promo-banner-wrapper">
        
        <div class="promo-banner__title">ScyllaDB University Live | Free Virtual Training Event</div>
        <a class="promo-banner__button button button--reverse" href="#"
           target="_blank" rel="noopener noreferrer">Learn more</a>
        <button class="promo-banner__close">
            <i class="icon-cancel"></i>
        </button>
    </div>
</section>
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../_static/img/scylladb-logo-horizontal.svg" alt="ScyllaDB Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Server
                    <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://opensource.docs.scylladb.com/">
                            <i class="icon-docs-open-source"></i>
                            ScyllaDB Open Source
                        </a>
                    </li>
                    <li>
                        <a href="https://enterprise.docs.scylladb.com/">
                            <i class="icon-docs-enterprise"></i>ScyllaDB Enterprise
                        </a>
                    </li>
                    <li>
                        <a href="https://scylla.docs.scylladb.com/stable/alternator/alternator.html">
                            <i class="icon-docs-alternator"></i>
                            ScyllaDB Alternator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="https://docs.scylladb.com/scylla-cloud/" class="scylla-dropdown__title">Cloud</a>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="icon-docs-manager"></i>ScyllaDB Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="icon-docs-monitoring"></i>ScyllaDB
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="icon-docs-operator"></i>ScyllaDB Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/">
                            <i class="icon-docs-nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/">
                            <i class="icon-docs-alternator"></i>DynamoDB Drivers
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://www.scylladb.com/download/" class="button">Download</a>
        </div>
    </div>
    <div class="header-search-box">
        <i class="dark-theme-toggler icon-theme"></i>
        <div class="search-box">
            <ci-search></ci-search>
        </div>
    </div>
    <div class="side-nav-toggle">
    <i class="dark-theme-toggler icon-theme"></i>
    <div class="side-nav-toggle__button" data-toggle="side-nav">
        <i class="icon-menu"></i>
    </div>
</div>
</header>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    
    <div class="admonition caution">
        <p class="admonition-title">Caution</p>
        <p>
            
                You're viewing documentation for a previous version of Scylla Operator.
            
            <a href="../../stable/index.html">Switch to the latest stable version.</a>
        </p>
    </div>

                
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://docs.scylladb.com"
           class="bread__highlight">
            <i class="icon-home"></i> ScyllaDB Docs
        </a>
    </span>
    <span class="bread__item">
        <a href="../index.html"
           class="bread__highlight">
            Scylla Operator
        </a>
    </span>
    
        <span class="bread__item">
            <a href="index.html" class="bread__highlight">
                Deploying multi-datacenter ScyllaDB clusters in Kubernetes
            </a>
        </span>
    
    <span class="bread__item bread__item--last">Build multiple GKE clusters with inter-Kubernetes networking</span>
</div>
                    </div>
                
                <section id="build-multiple-gke-clusters-with-inter-kubernetes-networking">
<h1>Build multiple GKE clusters with inter-Kubernetes networking<a class="headerlink" href="#build-multiple-gke-clusters-with-inter-kubernetes-networking" title="Link to this heading">¶</a></h1>
<p>This document describes the process of creating multiple GKE clusters in a shared VPC and explains the steps necessary for configuring inter-Kubernetes networking between clusters in different regions.
The interconnected clusters can serve as a platform for <a class="reference internal" href="multidc.html"><span class="std std-doc">deploying a Multi Datacenter ScyllaDB cluster</span></a>.</p>
<p>This guide will walk you through the process of creating and configuring GKE clusters in two distinct regions. Although it is only an example setup, it can easily be built upon to create infrastructure tailored to your specific needs.
For simplicity, several predefined values are used throughout the document. The values are only exemplary and can be adjusted to your preference.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h2>
<p>To follow the below guide, you first need to install and configure the following tools that you will need to create and manage GCP and Kubernetes resources:</p>
<ul class="simple">
<li><p>gcloud CLI - Google Cloud Command Line Interface, a command line tool for working with Google Cloud resources and services directly.</p></li>
<li><p>kubectl – A command line tool for working with Kubernetes clusters.</p></li>
</ul>
<p>See <a class="reference external" href="https://cloud.google.com/sdk/docs/install-sdk">Install the Google Cloud CLI</a> in GCP documentation and <a class="reference external" href="https://kubernetes.io/docs/tasks/tools/">Install Tools</a> in Kubernetes documentation for reference.</p>
</section>
<section id="create-and-configure-a-vpc-network">
<h2>Create and configure a VPC network<a class="headerlink" href="#create-and-configure-a-vpc-network" title="Link to this heading">¶</a></h2>
<p>For the clusters to have inter-Kubernetes networking, you will create a virtual network shared between all the instances, with dedicated subnets for each of the clusters.
To create the subnets manually, create the network in custom subnet mode.</p>
<section id="create-the-vpc-network">
<h3>Create the VPC network<a class="headerlink" href="#create-the-vpc-network" title="Link to this heading">¶</a></h3>
<p>Run the below command to create the network:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>create<span class="w"> </span>scylladb<span class="w"> </span>--subnet-mode<span class="o">=</span>custom
</pre></div>
</div>
<p>With the VPC network created, create a dedicated subnet with secondary CIDR ranges for their Pod and Service pools in each region which the clusters will reside in.</p>
</section>
<section id="create-vpc-network-subnets">
<h3>Create VPC network subnets<a class="headerlink" href="#create-vpc-network-subnets" title="Link to this heading">¶</a></h3>
<p>To create a subnet for the first cluster in region <code class="docutils literal notranslate"><span class="pre">us-east1</span></code>, run the below command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>subnets<span class="w"> </span>create<span class="w"> </span>scylladb-us-east1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>us-east1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>scylladb<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--range<span class="o">=</span><span class="m">10</span>.0.0.0/20<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--secondary-range<span class="o">=</span><span class="s1">&#39;cluster=10.1.0.0/16,services=10.2.0.0/20&#39;</span>
</pre></div>
</div>
<p>To create a subnet for the second cluster in region <code class="docutils literal notranslate"><span class="pre">us-west1</span></code>, run the below command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>compute<span class="w"> </span>networks<span class="w"> </span>subnets<span class="w"> </span>create<span class="w"> </span>scylladb-us-west1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--region<span class="o">=</span>us-west1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>scylladb<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--range<span class="o">=</span><span class="m">172</span>.16.0.0/20<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--secondary-range<span class="o">=</span><span class="s1">&#39;cluster=172.17.0.0/16,services=172.18.0.0/20&#39;</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>It is required that the IPv4 address ranges of the subnets allocated for the GKE clusters do not overlap.</p>
</div>
<p>Refer to <a class="reference external" href="https://cloud.google.com/kubernetes-engine/docs/how-to/alias-ips">Create a VPC-native cluster</a> and <a class="reference external" href="https://cloud.google.com/vpc/docs/alias-ip">Alias IP ranges</a> in GKE documentation for more information about VPC native clusters and alias IP ranges.</p>
</section>
</section>
<section id="create-gke-clusters">
<h2>Create GKE clusters<a class="headerlink" href="#create-gke-clusters" title="Link to this heading">¶</a></h2>
<p>With the VPC network created, you will now create two VPC native GKE clusters in dedicated regions.</p>
<section id="create-the-first-gke-cluster">
<h3>Create the first GKE cluster<a class="headerlink" href="#create-the-first-gke-cluster" title="Link to this heading">¶</a></h3>
<p>Run the following command to create the first GKE cluster in the <code class="docutils literal notranslate"><span class="pre">us-east1</span></code> region:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>container<span class="w"> </span>clusters<span class="w"> </span>create<span class="w"> </span>scylladb-us-east1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--location<span class="o">=</span>us-east1-b<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--node-locations<span class="o">=</span><span class="s1">&#39;us-east1-b,us-east1-c&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--machine-type<span class="o">=</span>n1-standard-8<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--num-nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--disk-type<span class="o">=</span>pd-ssd<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--disk-size<span class="o">=</span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--image-type<span class="o">=</span>UBUNTU_CONTAINERD<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--no-enable-autoupgrade<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--no-enable-autorepair<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--enable-ip-alias<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>scylladb<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnetwork<span class="o">=</span>scylladb-us-east1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cluster-secondary-range-name<span class="o">=</span>cluster<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--services-secondary-range-name<span class="o">=</span>services
</pre></div>
</div>
<p>Refer to <a class="reference internal" href="../gke.html#creating-a-gke-cluster"><span class="std std-ref">Creating a GKE cluster</span></a> section of ScyllaDB Operator documentation for more information regarding the configuration and deployment of additional node pools, including the one dedicated for ScyllaDB nodes.</p>
<p>You will need to get the cluster’s context for future operations. To do so, use the below command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>config<span class="w"> </span>current-context
</pre></div>
</div>
<p>For any <code class="docutils literal notranslate"><span class="pre">kubectl</span></code> commands that you will want to run against this cluster, use the <code class="docutils literal notranslate"><span class="pre">--context</span></code> flag with the value returned by the above command.</p>
<section id="deploy-scylladb-operator">
<h4>Deploy ScyllaDB Operator<a class="headerlink" href="#deploy-scylladb-operator" title="Link to this heading">¶</a></h4>
<p>Once the cluster is ready, refer to <a class="reference internal" href="../generic.html"><span class="std std-doc">Deploying Scylla on a Kubernetes Cluster</span></a> to deploy the ScyllaDB Operator and its prerequisites.</p>
</section>
<section id="prepare-nodes-for-running-scylladb">
<h4>Prepare nodes for running ScyllaDB<a class="headerlink" href="#prepare-nodes-for-running-scylladb" title="Link to this heading">¶</a></h4>
<p>Then, prepare the nodes for running ScyllaDB workloads and deploy a volume provisioner following the steps described in <a class="reference internal" href="../gke.html"><span class="std std-doc">Deploying Scylla on GKE</span></a> page of the documentation.</p>
</section>
</section>
<section id="create-the-second-gke-cluster">
<h3>Create the second GKE cluster<a class="headerlink" href="#create-the-second-gke-cluster" title="Link to this heading">¶</a></h3>
<p>Run the following command to create the second GKE cluster in the <code class="docutils literal notranslate"><span class="pre">us-west1</span></code> region:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>container<span class="w"> </span>clusters<span class="w"> </span>create<span class="w"> </span>scylladb-us-west1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--location<span class="o">=</span>us-west1-b<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--node-locations<span class="o">=</span><span class="s1">&#39;us-west1-b,us-west1-c&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--machine-type<span class="o">=</span>n1-standard-8<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--num-nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--disk-type<span class="o">=</span>pd-ssd<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--disk-size<span class="o">=</span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--image-type<span class="o">=</span>UBUNTU_CONTAINERD<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--no-enable-autoupgrade<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--no-enable-autorepair<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--enable-ip-alias<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="o">=</span>scylladb<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--subnetwork<span class="o">=</span>scylladb-us-west1<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cluster-secondary-range-name<span class="o">=</span>cluster<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--services-secondary-range-name<span class="o">=</span>services
</pre></div>
</div>
<p>Follow analogous steps to create the second GKE cluster and prepare it for running ScyllaDB.</p>
</section>
</section>
<section id="configure-the-firewall-rules">
<h2>Configure the firewall rules<a class="headerlink" href="#configure-the-firewall-rules" title="Link to this heading">¶</a></h2>
<p>When creating a cluster, GKE creates several ingress firewall rules that enable the instances to communicate with each other.
To establish interconnectivity between the two created Kubernetes clusters, you will now add the allocated IPv4 address ranges to their corresponding source address ranges.</p>
<p>First, retrieve the name of the firewall rule associated with the first cluster, which permits traffic between all Pods on a cluster, as required by the Kubernetes networking model.
The rule name is in the following format: <code class="docutils literal notranslate"><span class="pre">gke-[cluster-name]-[cluster-hash]-all</span></code>.</p>
<p>To retrieve it, run the below command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>compute<span class="w"> </span>firewall-rules<span class="w"> </span>list<span class="w"> </span>--filter<span class="o">=</span><span class="s1">&#39;name~gke-scylladb-us-east1-.*-all&#39;</span>
</pre></div>
</div>
<p>The output should resemble the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">NAME                                NETWORK   DIRECTION  PRIORITY  ALLOW                     DENY  DISABLED</span>
<span class="go">gke-scylladb-us-east1-f17db261-all  scylladb  INGRESS    1000      udp,icmp,esp,ah,sctp,tcp        False</span>
</pre></div>
</div>
<p>Modify the rule by updating the rule’s source ranges with the allocated Pod IPv4 address ranges of both clusters:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>compute<span class="w"> </span>firewall-rules<span class="w"> </span>update<span class="w"> </span>gke-scylladb-us-east1-f17db261-all<span class="w"> </span>--source-ranges<span class="o">=</span><span class="s1">&#39;10.1.0.0/16,172.17.0.0/16&#39;</span>
</pre></div>
</div>
<p>Follow the analogous steps for the other cluster. In this example, its corresponding firewall rule name is <code class="docutils literal notranslate"><span class="pre">gke-scylladb-us-west1-0bb60902-all</span></code>. To update it, you would run:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>compute<span class="w"> </span>firewall-rules<span class="w"> </span>update<span class="w"> </span>gke-scylladb-us-west1-0bb60902-all<span class="w"> </span>--source-ranges<span class="o">=</span><span class="s1">&#39;10.1.0.0/16,172.17.0.0/16&#39;</span>
</pre></div>
</div>
<p>Refer to <a class="reference external" href="https://cloud.google.com/kubernetes-engine/docs/concepts/firewall-rules">Automatically created firewall rules</a> in GKE documentation for more information.</p>
<hr class="docutils" />
<p>Having followed the above steps, you should now have a platform prepared for deploying a multi-datacenter ScyllaDB cluster.
Refer to <a class="reference internal" href="multidc.html"><span class="std std-doc">Deploy a multi-datacenter ScyllaDB cluster in multiple interconnected Kubernetes clusters</span></a> in ScyllaDB Operator documentation for guidance.</p>
</section>
</section>

                
                    <div class="post-content">
                        
    <div class="feedback-container">
        <p class="feedback-container__title">Was this page helpful?</p>
        <span data-tooltip tabindex="1" title="Yes" data-position="top">
            <button class="feedback-container__button" id="feedback-positive">
                <i class="feedback-container__icon icon-docs-thumbs-up"></i>
            </button>
        </span>
        <span data-tooltip tabindex="1" title="No" data-position="top">
            <button class="feedback-container__button" id="feedback-negative">
                <i class="feedback-container__icon icon-docs-thumbs-down"></i>
            </button>
        </span>
        <div class="feedback-container__message" id="feedback-message"></div>
    </div>

    <script>
        function resetFeedbackButtonActive() {
            const feedbackButtons = document.getElementsByClassName('feedback-container__button');
            for (let i = 0; i < feedbackButtons.length; i++) {
                feedbackButtons[i].classList.remove('active');
            }
        }

        function showMessage(liked) {
            const feedbackMessage = document.getElementById('feedback-message');
            const themeGithubRepository = true;
            let message = 'Great! Thanks for your feedback.';
            if (themeGithubRepository && !liked) {
                message = "Thanks for your feedback! Please don't hesitate to <a href='https://github.com/scylladb/scylla-operator/issues/new?title=docs:%20Issue on page Build multiple GKE clusters with inter-Kubernetes networking&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://operator.docs.scylladb.com/v1.12/multidc/gke%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation'>create an issue</a> if you have any suggestions on how we can improve.";
            }
            feedbackMessage.innerHTML = message;
        }

        function sendGaEvent(liked) {
            const event_label = liked ? "positive" : "negative";
            const event = "feedback_" + event_label;
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                'event': event,
            });
        }

        const positiveFeebackButton = document.getElementById('feedback-positive');
        const negativeFeedbackButton = document.getElementById('feedback-negative');

        positiveFeebackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(true);
            showMessage(true);
            positiveFeebackButton.classList.add('active');
        });

        negativeFeedbackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(false);
            showMessage(false);
            negativeFeedbackButton.classList.add('active');
        });
    </script>

                        <div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="eks.html">
                <button class="navigation__button">
                    <i class="icon-chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Build multiple Amazon EKS clusters with inter-Kubernetes networking
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="multidc.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />Deploy a multi-datacenter ScyllaDB cluster in multiple interconnected Kubernetes clusters
                </div>
                <button class="navigation__button">
                    <i class="icon-chevron-right"></i>
                </button>
            </a>
        
    </div>
</div>
                        <!-- Post content text -->
                    </div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="icon-docs-menu-collapse"></i>
    </button>
    <div class="side-nav-content" style="visibility: hidden;">
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__title">
            <a href="../index.html">Scylla Operator</a>
        </div>
        <div class="side-nav__versions"><ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
    <li class="scylla-dropdown__item">
        <a class="scylla-dropdown__title" href="#">
            
                v1.12
            
            <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
        </a>
        <ul class="menu scylla-dropdown__content">
            
                
                    <li>
                        <a href="../../stable/index.html">v1.14</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../v1.13/index.html">v1.13</a>
                    </li>
                
            
                
                    <li>
                        <a href="gke.html">v1.12</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../master/index.html">master</a>
                    </li>
                
            
            
        </ul>
    </li>
</ul></div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../generic.html">Deploying Scylla on a Kubernetes Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eks.html">Deploying Scylla on EKS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gke.html">Deploying Scylla on GKE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../helm.html">Deploying Scylla stack using Helm Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manager.html">Deploying Scylla Manager on a Kubernetes Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring.html">Monitoring</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../clients/index.html">Using ScyllaDB APIs</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon-arrow-dropdown"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../clients/discovery.html">Discovering ScyllaDB Nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/cql.html">Using CQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/alternator.html">Using Alternator (DynamoDB)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">Version  migrations</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../nodeoperations/index.html">Node operations using Scylla Operator</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon-arrow-dropdown"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../nodeoperations/scylla-upgrade.html">Upgrading version of Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nodeoperations/replace-node.html">Replacing a Scylla node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nodeoperations/automatic-cleanup.html">Automatic cleanup and replacement in case when k8s node is lost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nodeoperations/maintenance-mode.html">Maintenance mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nodeoperations/restore.html">Restore from backup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../exposing.html">Exposing ScyllaCluster</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Deploying multi-datacenter ScyllaDB clusters in Kubernetes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon-arrow-dropdown"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="eks.html">Build multiple Amazon EKS clusters with inter-Kubernetes networking</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Build multiple GKE clusters with inter-Kubernetes networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="multidc.html">Deploy a multi-datacenter ScyllaDB cluster in multiple interconnected Kubernetes clusters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade.html">Upgrade of Scylla Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../support/index.html">Support</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon-arrow-dropdown"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../support/overview.html">Support overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support/known-issues.html">Known issues</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../support/troubleshooting/index.html">Troubleshooting</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon-arrow-dropdown"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../support/troubleshooting/installation.html">Troubleshooting installation issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../support/must-gather.html">Gathering data with must-gather</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api-reference/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon-arrow-dropdown"></i></label><div class="break"></div><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api-reference/groups/scylla.scylladb.com.html">scylla.scylladb.com</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon-arrow-dropdown"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-reference/groups/scylla.scylladb.com/nodeconfigs.html">NodeConfig (scylla.scylladb.com/v1alpha1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference/groups/scylla.scylladb.com/scyllaclusters.html">ScyllaCluster (scylla.scylladb.com/v1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference/groups/scylla.scylladb.com/scylladbmonitorings.html">ScyllaDBMonitoring (scylla.scylladb.com/v1alpha1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-reference/groups/scylla.scylladb.com/scyllaoperatorconfigs.html">ScyllaOperatorConfig (scylla.scylladb.com/v1alpha1)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to Scylla Operator</a></li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>
            
                <div class="sidebar-right large-order-3">
                    <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a href="https://github.com/scylladb/scylla-operator/issues/new?title=docs:%20Issue on page Build multiple GKE clusters with inter-Kubernetes networking&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://operator.docs.scylladb.com/v1.12/multidc/gke%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation"
               target="_blank">
                <i class="icon-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                <a href="https://github.com/scylladb/scylla-operator/edit/master/docs/source/multidc/gke.md"
                   target="_blank">
                    <i class="icon-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Build multiple GKE clusters with inter-Kubernetes networking</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#create-and-configure-a-vpc-network">Create and configure a VPC network</a><ul>
<li><a class="reference internal" href="#create-the-vpc-network">Create the VPC network</a></li>
<li><a class="reference internal" href="#create-vpc-network-subnets">Create VPC network subnets</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-gke-clusters">Create GKE clusters</a><ul>
<li><a class="reference internal" href="#create-the-first-gke-cluster">Create the first GKE cluster</a><ul>
<li><a class="reference internal" href="#deploy-scylladb-operator">Deploy ScyllaDB Operator</a></li>
<li><a class="reference internal" href="#prepare-nodes-for-running-scylladb">Prepare nodes for running ScyllaDB</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-the-second-gke-cluster">Create the second GKE cluster</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configure-the-firewall-rules">Configure the firewall rules</a></li>
</ul>
</li>
</ul>

        </div>
    
</div>
                </div>
            
        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com"></a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/" target="_blank">Docs</a>
                <a class="footer-links__link" href="https://university.scylladb.com/" target="_blank">University</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/"
                    target="_blank">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/" target="_blank">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <i class="icon-slack"></i>
                    </span>
                </a>
                <a class="footer-actions__link" href="https://forum.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="Community forum" data-position="bottom">
                        <i class="icon-docs-community"></i>
                    </span>
                </a>
            </div>
        </div>

        <div class="footer-bottom">
            
                <div class="footer-bottom__copyright">
                    
                        
                            &#169; 2024, ScyllaDB. All rights reserved.
                        
                    
                </div>
            
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 14 October 2024.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a href="http://sphinx-doc.org/">Sphinx 7.4.7</a> &amp;
                <a href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.8.1</a>
            </div>
        </div>
    </div>
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                    style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>